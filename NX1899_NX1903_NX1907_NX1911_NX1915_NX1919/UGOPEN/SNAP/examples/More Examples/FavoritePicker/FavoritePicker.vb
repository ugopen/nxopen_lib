Option Strict Off

'------------------------------------------------------------------------------
'Represents a custom dialog generated by the NX Block UI Styler
'------------------------------------------------------------------------------
Partial Public Class FavoritePicker
   Inherits Snap.UI.BlockDialog
   Public Shared Sub Main()
      ' The path should point to the dlx file specific location
      Dim theDlxFileName As String = "C:\FavoritePicker.dlx"
      theFavoritePicker = New FavoritePicker(theDlxFileName)
      theFavoritePicker.Show()
   End Sub

   '------------------------------------------------------------------------------
   '  This function specifies when/how this application is to be unloaded from memory)
   '------------------------------------------------------------------------------
   Public Shared Function GetUnloadOption() As Integer
      ' Return CType(NXOpen.Session.LibraryUnloadOption.Explicitly, Integer)      ' By using File-->Utilities-->Unload
      Return CType(NXOpen.Session.LibraryUnloadOption.Immediately, Integer)     ' Immediately after executing
      ' Return CType(NXOpen.Session.LibraryUnloadOption.AtTermination, Integer)   ' When NX is terminated
   End Function

   '------------------------------------------------------------------------------
   'InitializeCallback -- called during the dialog construction and just before the values are loaded from dialog memory 
   '------------------------------------------------------------------------------
   Public Sub InitializeCallback()
      ChooseFruit = Snap.UI.Block.Enumeration.GetBlock(Me.NXOpenBlockDialog, "ChooseFruit")
      ChooseNumber = Snap.UI.Block.Integer.GetBlock(Me.NXOpenBlockDialog, "ChooseNumber")
      BigButton = Snap.UI.Block.Button.GetBlock(Me.NXOpenBlockDialog, "BigButton")
      Message = Snap.UI.Block.String.GetBlock(Me.NXOpenBlockDialog, "Message")
   End Sub

   '------------------------------------------------------------------------------
   'ApplyCallback -- called when the user clicks the Apply button
   '------------------------------------------------------------------------------
   Public Function ApplyCallback() As Integer
      ApplyCallback = 0
      Snap.InfoWindow.WriteLine(Message.Value)
   End Function

   '------------------------------------------------------------------------------
   'UpdateCallback -- called whenever the user changes anything in the dialog
   '------------------------------------------------------------------------------
   Public Function UpdateCallback(ByVal block As NXOpen.BlockStyler.UIBlock) As Integer
      If block Is ChooseFruit.NXOpenBlock Then
         '---- Enter your code here -----

      ElseIf block Is ChooseNumber.NXOpenBlock Then
         '---- Enter your code here -----

      ElseIf block Is BigButton.NXOpenBlock Then

         Dim random As System.Random = New System.Random()
         ChooseFruit.Value = random.Next() Mod 3
         ChooseNumber.Value = random.Next() Mod 100

      ElseIf block Is Message.NXOpenBlock Then
         '---- Enter your code here -----

      End If

      UpdateCallback = 0
      Message.Value = ChooseFruit.SelectedItem + " and " + ChooseNumber.Value.ToString()
   End Function

   '------------------------------------------------------------------------------
   'OkCallback -- called when the user clicks the OK button
   '------------------------------------------------------------------------------
   Public Function OkCallback() As Integer
      OkCallback = 0
      OkCallback = ApplyCallback()
   End Function

End Class
