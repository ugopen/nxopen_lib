/*******************************************************************************

   Copyright (c) 1998-2001 Unigraphics Solutions Inc.
                 Unpublished - All rights reserved
________________________________________________________________________________



  

File description:

   Internal type definitions for UF_SF_UGS_MESH (Scenario UGS Mesher)
   module.

*******************************************************************************/


#ifndef UF_SF_UGS_MESH_H_INCLUDED
#define UF_SF_UGS_MESH_H_INCLUDED

#include <uf_sf_types.h>

#ifdef __cplusplus
extern "C" {
#endif

/***************************************************************************
 *   Enumeration:-UF_SF_ugs_mesher_midnode_option_t
 *
 *   This enumeration allows the specification of how midnodes should be
 *   placed during meshing.
 *************************************************************************** */
typedef enum
{
    UF_SF_UGS_MESHER_straight_midnodes = 0,   /* All midnodes will be placed
                                                 at straight line linear
                                                 location between corner
                                                 nodes. */
    UF_SF_UGS_MESHER_curved_midnodes = 1,     /* All midnodes will be project
                                                 to underlying geometry. */
    UF_SF_UGS_MESHER_mixed_midnodes = 2       /* All midnodes will be projected
                                                 to underlying geometry, unless
                                                 doing so would input Jacobian
                                                 error threshold. */
} UF_SF_ugs_mesher_midnode_option_t;

/***************************************************************************
 *   Enumeration:-UF_SF_ugs_2d_mesher_elem_type_t
 *
 *   This enumeration allows the specification of what 2d shell element type
 *   should be generated by a shell mesher.
 *************************************************************************** */
typedef enum
{
    UF_SF_UGS_MESHER_tri3 = 0,
    UF_SF_UGS_MESHER_tri6 = 1,
    UF_SF_UGS_MESHER_quad4 = 2,
    UF_SF_UGS_MESHER_quad8 = 3
} UF_SF_ugs_2d_mesher_elem_type_t;

/***************************************************************************
 *   Structure :- UF_SF_ugs_tet_mesh_parms_s
 *
 *   This structure allows specification of tetrahedral meshing parameters.
 *
 *   Initialization :- This structure can be initialized with the
 *   UF_SF_ugs_tet_mesh_parms_INIT macro.
 *************************************************************************** */
typedef struct UF_SF_ugs_tet_mesh_parms_s
{
    int midnodes;                            /* TRUE for tet10s,
                                                FALSE for tet4s. */
    double element_size;                     /* Desired element size.  If
                                                zero or negative, then mesher
                                                will choose element size
                                                internally. */
    UF_SF_ugs_mesher_midnode_option_t midnode_option;
                                             /* Whether to project midnodes
                                                or not. */
    double maximum_midnode_jacobian;         /* If midnode_option =
                                                UF_SF_UGS_MESHER_mixed_midnodes,
                                                any element with a jacobian
                                                value higher than
                                                maximum_midnode_jacobian will
                                                have its midnodes
                                                straightened. */
    double minimum_face_angle;               /* Minimum angle at corner of a
                                                face that can support element.
                                                corners smaller than this will
                                                be pinched out.  This angle is
                                                measured in degrees. */
    int surf_mesh_size_variation;           /* This controls how much variation
                                                in element size is
                                                desired/permitted in the mesh on
                                                the surface of the bodies being
                                                meshed. Valid values go from 0
                                                to 100.  This number does not
                                                coorespond directly to any
                                                actual meshing parameter, but
                                                rather is a relative scale that
                                                the user can use to indicate
                                                their tolerance for mesh
                                                variation.  It is used
                                                internally in the mesher to
                                                calculate expansion factors and
                                                a minimum element size. 0
                                                means that there will be
                                                minimumal element size
                                                variation.  100 means that there
                                                will be maximum element size
                                                variation. */
    int tet_mesh_size_variation;             /* This controls whether the tets
                                                are permitted to expand as you
                                                progress into the interior of
                                                the body.  Valid values go from
                                                0 to 100.  0 means that
                                                element sizes must remain
                                                relatively constant.  100 means
                                                that the elements can expand
                                                very rapidly. */
} UF_SF_ugs_tet_mesh_parms_t, *UF_SF_ugs_tet_mesh_parms_p_t;

#define UF_SF_ugs_tet_mesh_parms_INIT( mesh_parms )                            \
   {                                                                           \
    (mesh_parms)->midnodes                   = TRUE;                           \
    (mesh_parms)->element_size               = -1.0;                          \
    (mesh_parms)->midnode_option             = UF_SF_UGS_MESHER_mixed_midnodes;\
    (mesh_parms)->maximum_midnode_jacobian   = 20.0;                           \
    (mesh_parms)->minimum_face_angle         = 20.0;                           \
    (mesh_parms)->surf_mesh_size_variation   = 0;                              \
    (mesh_parms)->tet_mesh_size_variation    = 0;                              \
   }

/***************************************************************************
 *   Structure :- UF_SF_ugs_2d_mesh_parms_s
 *
 *   This structure allows specification of 2d shell meshing parameters.
 *
 *   Initialization :- This structure can be initialized with the
 *   UF_SF_ugs_2d_mesh_parms_INIT macro.
 *************************************************************************** */
typedef struct UF_SF_ugs_2d_mesh_parms_s
{
    UF_SF_ugs_2d_mesher_elem_type_t element_type;
                                             /* Desired element type. */
    double element_size;                     /* Desired element size.  If
                                                zero or negative, then mesher
                                                will choose element size
                                                internally. */
    double edge_match_tolerance;             /* UG edge matching
                                                tolerance. */
    int format_mesh;                         /* TRUE if 2d mesh is a shell
                                                mesh that should be formatted
                                                to the solver.  FALSE if 2d
                                                mesh is a seed mesh and not to
                                                be formated out to solver.  */
    int attempt_quad_mapping;                /* TRUE if map mesher should be
                                                tried on faces for quad meshes
                                                or if free mesher should be
                                                called regardless of face
                                                shape. */
    int split_poor_quads;                    /* TRUE if poorly shaped quads
                                                should be split into
                                                triangles.
                                                FALSE if quads should be kept
                                                regardless of quality. */
    double maximum_quad_warp;                /* if split_poor_quads == TRUE,
                                                this is the warp quality
                                                threshold.  Any quad with
                                                greater warp than this will
                                                be split. */
    UF_SF_ugs_mesher_midnode_option_t midnode_option;
                                             /* Whether to project midnodes
                                                or not. */
    double maximum_midnode_jacobian;         /* If midnode_option =
                                                UF_SF_UGS_MESHER_mixed_midnodes,
                                                any element with a jacobian
                                                value higher than
                                                maximum_midnode_jacobian will
                                                have its midnodes
                                                straightened. */
    double minimum_face_angle;               /* Minimum angle at corner of a
                                                face that can support element.
                                                corners smaller than this will
                                                be pinched out.  This angle is
                                                measured in degrees. */
    int surf_mesh_size_variation;           /* This controls how much variation
                                                in element size is
                                                desired/permitted in the mesh on
                                                the surface of the bodies being
                                                meshed. Valid values go from 0
                                                to 100.  This number does not
                                                coorespond directly to any
                                                actual meshing parameter, but
                                                rather is a relative scale that
                                                the user can use to indicate
                                                their tolerance for mesh
                                                variation.  It is used
                                                internally in the mesher to
                                                calculate expansion factors and
                                                a minimum element size.  0
                                                means that there will be
                                                minimumal element size
                                                variation.  100 means that there
                                                will be maximum element size
                                                variation. */
} UF_SF_ugs_2d_mesh_parms_t, *UF_SF_ugs_2d_mesh_parms_p_t;

#define UF_SF_ugs_2d_mesh_parms_INIT( mesh_parms )                             \
{                                                                              \
    (mesh_parms)->element_type               = UF_SF_UGS_MESHER_quad4;         \
    (mesh_parms)->element_size               = -1.0;                           \
    (mesh_parms)->edge_match_tolerance       = 0.508;                          \
    (mesh_parms)->format_mesh                = TRUE;                           \
    (mesh_parms)->attempt_quad_mapping       = TRUE;                           \
    (mesh_parms)->split_poor_quads           = TRUE;                           \
    (mesh_parms)->maximum_quad_warp          = 10.0;                           \
    (mesh_parms)->midnode_option             = UF_SF_UGS_MESHER_mixed_midnodes;\
    (mesh_parms)->maximum_midnode_jacobian   = 5.0;                            \
    (mesh_parms)->minimum_face_angle         = 20.0;                           \
    (mesh_parms)->surf_mesh_size_variation   = 0;                              \
}


#ifdef __cplusplus
}
#endif

#endif  /* UF_SF_COMPOSITE_H_INCLUDED  */
